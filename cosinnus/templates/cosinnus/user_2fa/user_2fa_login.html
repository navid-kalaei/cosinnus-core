{% extends "cosinnus/registration/login.html" %}
{% load i18n two_factor cosinnus_tags %}


{% block content %}
    <form action="." method="post" enctype="multipart/form-data" class="cosinnus-form form-horizontal" role="form">
        {% csrf_token %}
        
        <div class="content-box">
            {{ form.non_field_errors }}
            
            <h4>{% block title %}{% trans "Login" %}{% endblock %}</h4>

            {% if two_factor_method == 'token' %}
                <p class="textfield transparent">
                    {% blocktrans trimmed %}Please enter the tokens generated by your token generator.{% endblocktrans %}
                </p>
            {% elif two_factor_method == 'backup' %}
	            <p class="textfield transparent">
	                {% blocktrans trimmed %}Use this form for entering backup tokens for logging in.
		                These tokens have been generated for you to print and keep safe. Please
		                enter one of these backup tokens to login to your account.{% endblocktrans %}
	            </p>
            {% endif %}
            
            {% trans "Device" as device_label %}
            {% captureas device_legend %}{% trans "legend" %}{% endcaptureas %}
            {% captureas device_placeholder %}{% trans "placeholder" %}{% endcaptureas %}
            {% include 'cosinnus/fields/default_field.html' with field=form.otp_device label=device_label placeholder=device_placeholder legend=device_legend %}
            
            
            {% trans "Token" as token_label %}
            {% captureas token_legend %}{% trans "legend" %}{% endcaptureas %}
            {% captureas token_placeholder %}{% trans "placeholder" %}{% endcaptureas %}
            {% include 'cosinnus/fields/default_field.html' with field=form.otp_token label=token_label placeholder=token_placeholder legend=token_legend %}
            
        </div>

        <button type="submit" class="btn btn-emphasized btn-autosize">
            <ul class="media-list">
                <li class="media">
                    <span class="pull-left" tabindex="-1">
                        <i class="fa fa-arrow-right"></i>
                    </span>
                    <div class="media-body">
                        {% if two_factor_method == 'token' %}
                            {% trans 'Log in' %}
                        {% elif two_factor_method == 'backup' %}
                            {% trans "Use Backup Token" %}
                        {% endif %}
                    </div>
                </li>
            </ul>
        </button>

        <a class="btn btn-emphasized btn-autosize pull-left no-margin" href="{% url "logout" %}">
            <ul class="media-list">
                <li class="media">
                    <span class="pull-left" tabindex="-1">
                        <i class="fas fa-sign-out-alt"></i>
                    </span>
                    <div class="media-body">
                        {% trans "Log out" %}
                    </div>
                </li>
            </ul>
        </a>

    </form>

{% endblock content %}
